<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover"
  />
  <title>–ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç –∫–æ–ª–ª–µ–∫—Ç–∏–≤–∞ –î–†–ù–£</title>

  <!-- –®—Ä–∏—Ñ—Ç—ã -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Montserrat:wght@700;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --blue:#0033A0;
      --cyan:#00B4F0;
      --gold:#f6c453;
      --bg1:#0b1020;
      --bg2:#121a33;
      --glass: rgba(255,255,255,.08);
      --glass-border: rgba(255,255,255,.25);
      --text:#e8efff;
      --muted:#b7c4ff;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:
        radial-gradient(1200px 600px at 10% 10%, #1c2545 0%, transparent 60%),
        radial-gradient(1000px 500px at 90% 0%, #16224a 0%, transparent 65%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      color:var(--text);
      font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;

      /* –ú–û–ë–ò–õ–¨–ù–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø: –∏—Å–ø–æ–ª—å–∑—É–µ–º 100dvh –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤—ã—Å–æ—Ç—ã –Ω–∞ iOS */
      min-height: 100dvh;
      overflow: hidden;
    }

    /* –ê–Ω–∏–º–∞—Ü–∏—è ¬´—Å–µ–≤–µ—Ä–Ω–æ–≥–æ —Å–∏—è–Ω–∏—è¬ª */
    .aurora, .aurora::before, .aurora::after{
      position:fixed; inset:-20vmax;
      pointer-events:none; z-index:0;
      content:"";
      filter: blur(60px) saturate(120%);
      background:
        radial-gradient(50% 40% at 20% 30%, rgba(0,180,240,.25), transparent 60%),
        radial-gradient(45% 35% at 80% 20%, rgba(0,120,255,.18), transparent 60%),
        radial-gradient(35% 30% at 50% 80%, rgba(255,215,128,.15), transparent 60%);
      animation: drift 18s linear infinite;
    }
    .aurora::before{ animation-duration: 26s; mix-blend-mode:screen; }
    .aurora::after{ animation-duration: 32s; mix-blend-mode:overlay; }

    @keyframes drift{
      0%   { transform:translate3d(-3%, -2%, 0) rotate(0deg) scale(1.05); }
      50%  { transform:translate3d(3%, 2%, 0) rotate(180deg) scale(1.08); }
      100% { transform:translate3d(-3%, -2%, 0) rotate(360deg) scale(1.05); }
    }

    /* –ú–µ—Ä—Ü–∞—é—â–∏–µ ¬´–∑–≤—ë–∑–¥—ã¬ª */
    .stars{
      position:fixed; inset:0; z-index:1; pointer-events:none;
      background-image:
        radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,.9) 50%, transparent 52%),
        radial-gradient(1.5px 1.5px at 70% 20%, rgba(255,255,255,.7) 50%, transparent 52%),
        radial-gradient(1.5px 1.5px at 40% 70%, rgba(255,255,255,.8) 50%, transparent 52%),
        radial-gradient(2px 2px at 85% 65%, rgba(255,255,255,.9) 50%, transparent 52%),
        radial-gradient(1.5px 1.5px at 10% 80%, rgba(255,255,255,.6) 50%, transparent 52%);
      animation: twinkle 3.5s ease-in-out infinite alternate;
      opacity:.7;
    }
    @keyframes twinkle{ from{opacity:.35} to{opacity:.9} }

    /* –û—Å–Ω–æ–≤–Ω–æ–π –±–ª–æ–∫-–ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ */
    .wrap{
      position:relative; z-index:2;
      min-height: 100dvh; /* –ú–û–ë–ò–õ–¨–ù–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø */
      width:100%;
      display:grid; place-items:center;
      padding: clamp(12px, 4vmin, 40px);
      padding-bottom: calc(16px + env(safe-area-inset-bottom)); /* –≤—ã—Ä–µ–∑—ã iPhone */
    }
    .card{
      width:min(960px, 96vw);
      max-width: 960px;
      padding: clamp(16px, 4vmin, 40px);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
      border:1px solid var(--glass-border);
      border-radius:24px;
      backdrop-filter: blur(16px);
      box-shadow: 0 16px 50px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.08);
      position:relative;
      overflow:hidden;
    }
    .card::before{
      content:"";
      position:absolute; inset:-2px;
      border-radius:26px;
      padding:2px;
      background: linear-gradient(135deg, rgba(246,196,83,.7), rgba(0,180,240,.55), rgba(255,255,255,.2));
      -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask-composite: xor; mask-composite: exclude;
      animation: borderGlow 6s linear infinite;
    }
    @keyframes borderGlow{
      0%{filter:hue-rotate(0deg)} 100%{filter:hue-rotate(360deg)}
    }

    .badge{
      display:inline-flex; align-items:center; gap:.6rem;
      padding:.56rem .9rem; border-radius:999px;
      font-weight:700; letter-spacing:.02em;
      background: linear-gradient(90deg, rgba(246,196,83,.25), rgba(255,255,255,.08));
      border:1px solid rgba(246,196,83,.6);
      color:var(--gold);
      text-transform:uppercase; font-size:.82rem;
      backdrop-filter: blur(6px);
    }
    .badge svg{ width:18px; height:18px; }

    h1{
      margin:12px 0 6px;
      font-family: Montserrat, Inter, system-ui, sans-serif;
      font-weight:900;
      line-height:1.12;
      font-size: clamp(24px, 7vw, 48px); /* –ú–û–ë–ò–õ–¨–ù–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø */
      letter-spacing:.01em;
      background: linear-gradient(180deg, #fff, #cfe7ff 50%, #9ad8ff);
      -webkit-background-clip:text; background-clip:text; color:transparent;
      text-shadow: 0 10px 24px rgba(0,0,0,.35);
    }
    .subtitle{
      margin:0 0 14px; color:var(--muted);
      font-weight:600; letter-spacing:.02em;
      font-size: clamp(13px, 3.6vw, 18px); /* –ú–û–ë–ò–õ–¨–ù–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø */
    }
    .msg{
      font-size: clamp(15px, 3.8vw, 19px); /* –ú–û–ë–ò–õ–¨–ù–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø */
      line-height:1.65; color:#eef3ff; margin-top:10px;
    }
    .msg b{ color:#fff }

    .footer{
      display:flex; gap:12px; flex-wrap:wrap; align-items:center; justify-content:space-between;
      margin-top:18px; color:#d3ddff; font-size:.95rem;
      border-top:1px dashed rgba(255,255,255,.25); padding-top:14px;
    }
    .team{ font-weight:700; color:#fff }
    .date{ opacity:.9 }

    .controls{
      display:flex; gap:10px; flex-wrap:wrap; margin-top:16px;
    }
    .btn{
      appearance:none; border:none; cursor:pointer;
      padding:.9rem 1rem; border-radius:14px;
      font-weight:800; letter-spacing:.02em;
      color:#0b1020; background: linear-gradient(180deg, #fff, #dce9ff);
      box-shadow: 0 10px 24px rgba(0,0,0,.2);
      transition: transform .15s ease, box-shadow .15s ease;
    }
    .btn:hover{ transform: translateY(-2px); box-shadow: 0 14px 28px rgba(0,0,0,.28) }
    .btn.secondary{
      background: linear-gradient(180deg, #ffe6a6, #f6c453);
      color:#3b2a00;
    }

    /* –•–æ–ª—Å—Ç —Ñ–µ–π–µ—Ä–≤–µ—Ä–∫–æ–≤ */
    canvas#fx{
      position:fixed; inset:0; z-index:1; pointer-events:none;
      width:100vw; height:100dvh; /* –ú–û–ë–ò–õ–¨–ù–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø */
    }

    /* –ü–æ–¥—Å–∫–∞–∑–∫–∞ */
    .hint{
      position:fixed; left:50%; bottom:12px; transform:translateX(-50%);
      z-index:3; font-size:12px; color:#e8efff; opacity:.75;
      padding:6px 10px; border-radius:999px;
      background: rgba(0,0,0,.25); backdrop-filter: blur(4px);
      padding-bottom: calc(6px + env(safe-area-inset-bottom)); /* –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞ */
    }

    /* –ú–û–ë–ò–õ–¨–ù–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø: –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ, –∫—Ä—É–ø–Ω—ã–µ –∫–Ω–æ–ø–∫–∏, –º–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ */
    @media (max-width: 480px){
      .aurora, .aurora::before, .aurora::after{ filter: blur(40px) saturate(110%); }
      .card{ border-radius:20px; padding: 16px }
      .badge{ font-size:.74rem; padding:.5rem .8rem }
      .controls{ gap:8px }
      .btn{ padding:.84rem 1rem; flex:1 1 100%; width:100% } /* –ø–æ–ª–Ω–æ—Ä–∞–∑–º–µ—Ä–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ */
      .footer{ font-size:.9rem; gap:8px }
    }

    /* –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç –º–µ–Ω—å—à–µ –¥–≤–∏–∂–µ–Ω–∏—è ‚Äî –æ—Ç–∫–ª—é—á–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏–∏ */
    @media (prefers-reduced-motion: reduce){
      .aurora, .aurora::before, .aurora::after{ animation: none }
      .stars{ animation: none }
    }
  </style>
</head>
<body>
  <div class="aurora" aria-hidden="true"></div>
  <div class="stars" aria-hidden="true"></div>
  <canvas id="fx" aria-hidden="true"></canvas>

  <div class="wrap">
    <section class="card" aria-label="–ü—Ä–∞–∑–¥–Ω–∏—á–Ω–æ–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ">
      <div class="badge" title="–õ—É—á—à–∏–π —Ä–∞–±–æ—Ç–Ω–∏–∫">
        <!-- –ö—É–±–æ–∫ -->
        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M6 4h12v2a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V4Z" stroke="currentColor" stroke-width="1.6"/>
          <path d="M18 6h3a3 3 0 0 1-3 3M6 6H3a3 3 0 0 0 3 3" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
          <path d="M9 10v2a3 3 0 0 0 3 3v0a3 3 0 0 0 3-3v-2M8 19h8" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
        </svg>
        –õ—É—á—à–∏–π —Ä–∞–±–æ—Ç–Ω–∏–∫ ‚Äî –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª
      </div>

      <h1>
        <span id="hello">–£–≤–∞–∂–∞–µ–º—ã–π(–∞—è)</span> <span id="name">–ö–æ–ª–ª–µ–≥–∞</span>!
      </h1>
      <p class="subtitle">–ù–∞—á–∞–ª—å–Ω–∏–∫ –æ—Ç–¥–µ–ª–∞. –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–∞—Å—Ç–æ–ª—å–∫–æ, —á—Ç–æ –º—ã –∏–Ω–æ–≥–¥–∞ –∑–∞–±—ã–≤–∞–µ–º —Ç–µ–±—è –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å üòä</p>

      <p class="msg">
        –û—Ç –≤—Å–µ–≥–æ <b>–∫–æ–ª–ª–µ–∫—Ç–∏–≤–∞ –î–†–ù–£</b> ‚Äî –∏—Å–∫—Ä–µ–Ω–Ω–∏–µ –ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è!
        –ú—ã –≤–∏–¥–∏–º, –∫–∞–∫–æ–π –º–æ—â–Ω—ã–π –≤–∫–ª–∞–¥ <b>—Å–≤–æ–∏–º –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–∏–∑–º–æ–º</b> —Ç—ã –≤–Ω–æ—Å–∏—à—å –≤ –æ–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
        –°–ø–∞—Å–∏–±–æ –∑–∞ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å, –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –ª–∏–¥–µ—Ä—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç.
      </p>
      <p class="msg">
        –ñ–µ–ª–∞–µ–º –∫—Ä–µ–ø–∫–æ–≥–æ <b>–∑–¥–æ—Ä–æ–≤—å—è</b>, —Å–µ–º—å–µ ‚Äî <b>–±–ª–∞–≥–æ–ø–æ–ª—É—á–∏—è</b>, –∞ —Ç–µ–±–µ ‚Äî –Ω–æ–≤—ã—Ö –ø–æ–±–µ–¥, –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –∑–∞–¥–∞—á –∏
        —Ç–æ–ª—å–∫–æ –ª—É—á—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –ü—É—Å—Ç—å –≤—Å—ë –ø–æ–ª—É—á–∞–µ—Ç—Å—è –ª–µ–≥–∫–æ, –∞ —Ü–µ–ª–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —è—Ä–∫–∏–º–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º–∏!
      </p>

      <div class="controls" aria-label="–ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è">
        <button class="btn secondary" id="burst">–°–∞–ª—é—Ç! üéÜ</button>
        <button class="btn" id="toggle">–í—ã–∫–ª—é—á–∏—Ç—å —Ñ–µ–π–µ—Ä–≤–µ—Ä–∫–∏</button>
        <button class="btn" id="share">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É-–ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
      </div>

      <div class="footer">
        <div class="team">–° —É–≤–∞–∂–µ–Ω–∏–µ–º, –∫–æ–ª–ª–µ–∫—Ç–∏–≤ –î–†–ù–£</div>
        <div class="date" id="date"></div>
      </div>
    </section>
  </div>

  <div class="hint" id="hint">–¢–∞–ø –ø–æ —ç–∫—Ä–∞–Ω—É –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–∞–ª—é—Ç ‚ú®</div>

  <script>
    // ===== –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ URL: ?name=–ò–º—è =====
    (function personalize(){
      const params = new URLSearchParams(location.search);
      const name = (params.get('name') || "").trim();
      if(name){
        document.getElementById('name').textContent = name;
        document.title = `–ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è ${name} ‚Äî –æ—Ç –∫–æ–ª–ª–µ–∫—Ç–∏–≤–∞ –î–†–ù–£`;
      }
      const today = new Date();
      document.getElementById('date').textContent = today.toLocaleDateString('ru-RU', {
        year:'numeric', month:'long', day:'numeric'
      });
    })();

    // ===== –ö–Ω–æ–ø–∫–∏ =====
    const btnBurst  = document.getElementById('burst');
    const btnToggle = document.getElementById('toggle');
    const btnShare  = document.getElementById('share');

    btnShare.addEventListener('click', async () => {
      try{
        await navigator.clipboard.writeText(location.href);
        btnShare.textContent = '–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ ‚úÖ';
        setTimeout(()=> btnShare.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É-–ø–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏–µ', 2200);
      }catch(e){
        alert('–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—Ä—É—á–Ω—É—é: ' + location.href);
      }
    });

    // ===== –§–µ–π–µ—Ä–≤–µ—Ä–∫–∏ (canvas), —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—ã–π =====
    const canvas = document.getElementById('fx');
    const ctx = canvas.getContext('2d', { alpha:true });
    let W, H;
    const isPhone = () => innerWidth <= 480;

    // –ú–û–ë–ò–õ–¨–ù–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø: –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º DPR –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
    function getDPR(){
      const dpr = window.devicePixelRatio || 1;
      return isPhone() ? Math.min(1.25, dpr) : Math.min(2, dpr);
    }
    let DPR = getDPR();

    function sizeCanvas(){
      DPR = getDPR();
      W = canvas.width  = Math.floor(innerWidth * DPR);
      H = canvas.height = Math.floor(window.innerHeight * DPR);
      canvas.style.width  = innerWidth + 'px';
      canvas.style.height = window.innerHeight + 'px';
    }
    window.addEventListener('resize', sizeCanvas, { passive:true });
    sizeCanvas();

    const rand = (min, max) => Math.random() * (max - min) + min;
    const TAU = Math.PI * 2;

    // –ú–û–ë–ò–õ–¨–ù–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø: –º–µ–Ω—å—à–µ —á–∞—Å—Ç–∏—Ü –∏ —Ä–µ–∂–µ –∑–∞–ª–ø—ã
    const gravity = (isPhone()? 0.035 : 0.04) * DPR;
    const friction = 0.985;
    const rockets = [];
    const particles = [];
    let running = true;

    function colorHSL(h,s,l){ return `hsl(${h} ${s}% ${l}%)`; }

    function spawnRocket(x = rand(W*0.2, W*0.8), y=H, targetY=rand(H*0.28, H*0.5)){
      rockets.push({
        x, y, vx: rand(-0.8,0.8)*DPR, vy: rand(-9,-12)*DPR,
        targetY, colorHue: rand(180, 360), trail:[]
      });
    }

    function explode(x, y, baseHue){
      const baseCount = isPhone() ? rand(46, 72) : rand(80, 120);
      const count = Math.floor(baseCount);
      const shape = Math.random()<0.2 ? 'ring' : 'burst';
      for(let i=0; i<count; i++){
        const angle = (i/count)*TAU + rand(-0.02,0.02);
        const speed = (shape==='ring' ? 3.0 : rand(1.4, 4.1)) * DPR;
        particles.push({
          x, y,
          vx: Math.cos(angle)*speed,
          vy: Math.sin(angle)*speed,
          life: rand(50, 90),
          alpha: 1,
          color: colorHSL((baseHue + rand(-12,12))|0, 100, rand(55, 70)),
          size: rand(1, 2.0) * DPR,
          sparkle: Math.random() < 0.18
        });
      }
      // –∑–æ–ª–æ—Ç–æ–π –∫–æ—Ä–æ–Ω–Ω—ã–π –±–ª–∏–∫ (—á—É—Ç—å –º–µ–Ω—å—à–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö)
      const crown = isPhone()? 16 : 24;
      for(let i=0;i<crown;i++){
        const a = i/crown*TAU;
        particles.push({
          x, y,
          vx: Math.cos(a)*rand(1.1,2.0)*DPR,
          vy: Math.sin(a)*rand(1.1,2.0)*DPR,
          life: rand(40,65), alpha:1,
          color: 'rgba(246,196,83,1)', size: 1.6*DPR, sparkle:true
        });
      }
    }

    function step(){
      ctx.clearRect(0,0,W,H);

      // –†–∞–∫–µ—Ç—ã
      for(let i=rockets.length-1;i>=0;i--){
        const r = rockets[i];
        r.trail.push({x:r.x, y:r.y});
        if(r.trail.length>5) r.trail.shift();

        r.x += r.vx;
        r.y += r.vy;
        r.vy += gravity * 0.5;

        // –°–ª–µ–¥ —Ä–∞–∫–µ—Ç—ã
        ctx.beginPath();
        for(let t=0; t<r.trail.length-1; t++){
          const a = t/(r.trail.length-1);
          ctx.strokeStyle = `hsla(${r.colorHue},100%,70%,${a*0.6})`;
          ctx.lineWidth = (1.3 + a*1.8)*DPR;
          ctx.moveTo(r.trail[t].x, r.trail[t].y);
          ctx.lineTo(r.trail[t+1].x, r.trail[t+1].y);
        }
        ctx.stroke();

        // –ì–æ–ª–æ–≤–∞
        ctx.fillStyle = colorHSL(r.colorHue, 100, 70);
        ctx.beginPath();
        ctx.arc(r.x, r.y, 2.0*DPR, 0, TAU);
        ctx.fill();

        if(r.vy >= 0 || r.y <= r.targetY || Math.random()<0.008){
          explode(r.x, r.y, r.colorHue);
          rockets.splice(i,1);
        }
      }

      // –ß–∞—Å—Ç–∏—Ü—ã
      const maxParticles = isPhone() ? 450 : 900; // –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
      if(particles.length > maxParticles){
        particles.splice(0, particles.length - maxParticles);
      }

      for(let i=particles.length-1;i>=0;i--){
        const p = particles[i];
        p.vx *= friction;
        p.vy = p.vy * friction + gravity;
        p.x += p.vx;
        p.y += p.vy;
        p.life--;
        p.alpha = Math.max(0, p.life/100);

        // –∏—Å–∫—Ä—ã
        if(p.sparkle && Math.random() < 0.14){
          ctx.fillStyle = 'rgba(255,255,255,.8)';
          ctx.fillRect(p.x, p.y, 1.2*DPR, 1.2*DPR);
        }

        ctx.globalAlpha = p.alpha;
        ctx.fillStyle = p.color;
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.size, 0, TAU);
        ctx.fill();
        ctx.globalAlpha = 1;

        if(p.alpha<=0 || p.x< -50 || p.x> W+50 || p.y>H+50) particles.splice(i,1);
      }

      if(running) requestAnimationFrame(step);
    }

    // –ê–≤—Ç–æ—Å–∞–ª—é—Ç (—Ä–µ–¥–∂–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö)
    function autoShow(){
      const batch = isPhone() ? 1 : 3;
      for(let i=0;i<batch;i++){
        setTimeout(()=> spawnRocket(), i*220);
      }
    }

    step();
    setTimeout(autoShow, 600);
    const autoTimer = setInterval(()=>{
      if(!running) return;
      if(Math.random() < (isPhone()? 0.55 : 0.8)) spawnRocket();
    }, isPhone()? 1100 : 900);

    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    btnBurst.addEventListener('click', ()=>{
      const n = isPhone()? 2 : 3;
      for(let i=0;i<n;i++) spawnRocket();
    }, { passive:true });

    // –¢–∞–ø –ø–æ —ç–∫—Ä–∞–Ω—É ‚Äî –≤–∑—Ä—ã–≤ –≤ —Ç–æ—á–∫–µ
    addEventListener('click', (e)=>{
      const rect = canvas.getBoundingClientRect();
      const x = (e.clientX - rect.left) * DPR;
      const y = (e.clientY - rect.top) * DPR;
      explode(x, y, Math.floor(rand(180,360)));
    }, { passive:true });

    btnToggle.addEventListener('click', ()=>{
      running = !running;
      btnToggle.textContent = running ? '–í—ã–∫–ª—é—á–∏—Ç—å —Ñ–µ–π–µ—Ä–≤–µ—Ä–∫–∏' : '–í–∫–ª—é—á–∏—Ç—å —Ñ–µ–π–µ—Ä–≤–µ—Ä–∫–∏';
      document.getElementById('hint').style.opacity = running ? '0.75' : '0.0';
      if(running) requestAnimationFrame(step);
    });

    // –≠–∫–æ–Ω–æ–º–∏–º –±–∞—Ç–∞—Ä–µ—é –ø—Ä–∏ —Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–∏
    document.addEventListener('visibilitychange', ()=>{
      if(document.hidden){ running = false; btnToggle.textContent='–í–∫–ª—é—á–∏—Ç—å —Ñ–µ–π–µ—Ä–≤–µ—Ä–∫–∏'; }
    });

    // –£–±–∏—Ä–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É —Å–ø—É—Å—Ç—è –ø–∞—Ä—É —Å–µ–∫—É–Ω–¥
    setTimeout(()=> {
      const hint = document.getElementById('hint');
      hint && (hint.style.transition='opacity .5s ease', hint.style.opacity='0');
    }, 4000);
  </script>
</body>
</html>
